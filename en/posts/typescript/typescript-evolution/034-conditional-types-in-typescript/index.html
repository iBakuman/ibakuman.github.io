
<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Overview TypeScript 2.8 introduced conditional types, a powerful and exciting { 令人兴奋的 } addition to the type system. Conditional types let us express non-uniform { 不统一的，不一致的 } type mappings, that is, type transformations that differ depending on a condition. Introduction to Conditional Types A conditional type describes a type relationship test and selects one of two possible types,'>
<title>Conditional Types in TypeScript</title><link rel='canonical' href='https://ibakuman.github.io/en/posts/typescript/typescript-evolution/034-conditional-types-in-typescript/'><link rel="prev" href="https://ibakuman.github.io/en/posts/typescript/typescript-evolution/033-per-file-jsx-factories-in-typescript/" /><link rel="next" href="https://ibakuman.github.io/en/posts/typescript/typescript-evolution/035-mapped-type-modifiers-in-typescript/" /><link rel="stylesheet" href="/css/style.min.2dbe6aa63c3db4336151571f1f586e464d373413c7924a1e8fefc1ade77ce12f.css" integrity="sha256-Lb5qpjw9tDNhUVcfH1huRk03NBPHkkoej+/Bred84S8="><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><meta property='og:title' content='Conditional Types in TypeScript'>
<meta property='og:description' content='Overview TypeScript 2.8 introduced conditional types, a powerful and exciting { 令人兴奋的 } addition to the type system. Conditional types let us express non-uniform { 不统一的，不一致的 } type mappings, that is, type transformations that differ depending on a condition. Introduction to Conditional Types A conditional type describes a type relationship test and selects one of two possible types,'>
<meta property='og:url' content='https://ibakuman.github.io/en/posts/typescript/typescript-evolution/034-conditional-types-in-typescript/'>
<meta property='og:site_name' content='iBakuman&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Posts' /><meta property='article:published_time' content='2023-01-02T21:26:26&#43;08:00'/><meta property='article:modified_time' content='2023-01-02T21:26:26&#43;08:00'/><meta property='og:image' content='https://ibakuman.github.io/img/default.png' />
<meta name="twitter:title" content="Conditional Types in TypeScript">
<meta name="twitter:description" content="Overview TypeScript 2.8 introduced conditional types, a powerful and exciting { 令人兴奋的 } addition to the type system. Conditional types let us express non-uniform { 不统一的，不一致的 } type mappings, that is, type transformations that differ depending on a condition. Introduction to Conditional Types A conditional type describes a type relationship test and selects one of two possible types,"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://ibakuman.github.io/img/default.png' /><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">

    </head>
    <body class="article-page"><script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            localStorage.setItem(colorSchemeKey, "dark");
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/en/">
                
                    

                    
                        
                        <img src="/img/avatar_hu607d9502653a863721bf402ab13c6bbf_56312_300x0_resize_box_3.png" width="300"
                            height="285" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">♈</span>
                
            </figure>
            
        

        <div class="site-meta">
            <h1 class="site-name"><a href="/en">iBakuman&#39;s Blog</a></h1>
            <h2 class="site-description">I am because you are.</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a
                        href='https://github.com/ibakuman'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a
                        href='https://twitter.com'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
            <li >
                <a href='/en/about/' >
                    
                    
                    
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                    
                    <span>About</span>
                </a>
            </li>
        
        
            <li >
                <a href='/en/archives/' >
                    
                    
                    
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                    
                    <span>Archives</span>
                </a>
            </li>
        
        
            <li >
                <a href='/en/search/' >
                    
                    
                    
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                    
                    <span>Search</span>
                </a>
            </li>
        
        
            <li >
                <a href='/en/links/' >
                    
                    
                    
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                    
                    <span>Links</span>
                </a>
            </li>
        

        <div class="menu-bottom-section">
                <li id="i18n-switch">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



                    <select name="language" onchange="window.location.href = this.selectedOptions[0].value">
                        
                            <option value="https://ibakuman.github.io/" >中文</option>
                        
                            <option value="https://ibakuman.github.io/en/" selected>English</option>
                        
                    </select>
                </li>
            

            
        </div>
    </ol>
</aside>
<main class="main full-width">
    <article class="main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/en/posts/typescript/typescript-evolution/034-conditional-types-in-typescript/">
                <img src="/gallery/landscape/05_hub432477bc07843360148c20e5d960cbf_635143_800x0_resize_q75_box.jpg"
                        srcset="/gallery/landscape/05_hub432477bc07843360148c20e5d960cbf_635143_800x0_resize_q75_box.jpg 800w, /gallery/landscape/05_hub432477bc07843360148c20e5d960cbf_635143_1600x0_resize_q75_box.jpg 1600w"
                        width="800"
                        height="450"
                        loading="lazy"
                        alt="Featured image of post Conditional Types in TypeScript" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/en/categories/typescript/" >
                TypeScript
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h1 class="article-title">
            <a href="/en/posts/typescript/typescript-evolution/034-conditional-types-in-typescript/">Conditional Types in TypeScript</a>
        </h1>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Jan 02, 2023</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    6 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>


    <section class="article-content  auto-numbering ">
    
    
    <h2 id="overview">Overview</h2>
<p>TypeScript 2.8 introduced <a class="link" href="https://github.com/Microsoft/TypeScript/pull/21316"  target="_blank" rel="noopener"
    >conditional types</a>, a powerful and <span class="ibakuman-inline-translation">exciting<sub> { 令人兴奋的 }</sub></span> addition to the type system. Conditional types let us express <span class="ibakuman-inline-translation">non-uniform<sub> { 不统一的，不一致的 }</sub></span> type mappings, that is, type transformations that differ depending on a condition.</p>
<h2 id="introduction-to-conditional-types">Introduction to Conditional Types</h2>
<p>A conditional type describes a type relationship test and selects one of two possible types, depending on the outcome of that test. It always has the following form:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="nx">T</span> <span class="kr">extends</span> <span class="nx">U</span> <span class="o">?</span> <span class="nx">X</span> : <span class="kt">Y</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Conditional types use the <span class="ibakuman-inline-translation">familiar<sub> { 熟悉的；常见的 }</sub></span> <code>... ? ... : ...</code> syntax that JavaScript uses for conditional expressions. <code>T</code>, <code>U</code>, <code>X</code>, and <code>Y</code> stand for arbitrary types. The <code>T extends U</code> part describes the type relationship test. If this condition is met, the type <code>X</code> is selected; otherwise the type <code>Y</code> is selected.</p>
<p>In human language, this conditional type reads as follows: <em>If the type <code>T</code> is assignable to the type <code>U</code>, select the type <code>X</code>; otherwise, select the type <code>Y</code>.</em></p>
<p>Here&rsquo;s an example for a conditional type that is predefined in TypeScript&rsquo;s <em>lib.es5.d.ts</em> type definition file:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Exclude null and undefined from T
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">NonNullable</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">&gt;</span> <span class="o">=</span> <span class="nx">T</span> <span class="kr">extends</span> <span class="kc">null</span> <span class="o">|</span> <span class="kc">undefined</span> <span class="o">?</span> <span class="kt">never</span> <span class="o">:</span> <span class="nx">T</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The <code>NonNullable&lt;T&gt;</code> type selects the <code>never</code> type if the type <code>T</code> is assignable to either the type <code>null</code> or the type <code>undefined</code>; otherwise it keeps the type <code>T</code>. The <a class="link" href="https://mariusschulz.com/blog/the-never-type-in-typescript"  target="_blank" rel="noopener"
    ><code>never</code> type</a> is TypeScript&rsquo;s <a class="link" href="https://en.wikipedia.org/wiki/Bottom_type"  target="_blank" rel="noopener"
    >bottom type</a>, the type for values that never occur.</p>
<h2 id="distributive-conditional-types">Distributive Conditional Types</h2>
<p>So why is the combination of a conditional type and the <code>never</code> type useful? <span class="ibakuman-inline-note">It effectively allows us to remove <span class="ibakuman-inline-translation">constituent<sub> { 组成的 }</sub></span> types from a union type</span>. If the relationship test in the conditional type checks a naked type parameter, the conditional type is called a <em>distributive conditional type</em>, and it is <em>distributed</em> over a union type when that union type is instantiated.</p>
<p>Since <code>NonNullable&lt;T&gt;</code> checks a naked type parameter, it is distributed over a union type <code>A | B</code>. This means that <code>NonNullable&lt;A | B&gt;</code> is resolved as <code>NonNullable&lt;A&gt; | NonNullable&lt;B&gt;</code>. If e.g. <code>NonNullable&lt;A&gt;</code> resolves to the <code>never</code> type, we can remove <code>A</code> from the resulting union type, effectively filtering out type <code>A</code> due to its nullability. The same is true for <code>NonNullable&lt;B&gt;</code>.</p>
<p>This description was <span class="ibakuman-inline-translation">fairly<sub> { 相当地 }</sub></span> abstract, so let&rsquo;s look at a concrete example. We&rsquo;ll define an <code>EmailAddress</code> type alias that represents a union of four different types, including the <code>null</code> and <code>undefined</code> unit types:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">EmailAddress</span> <span class="o">=</span> <span class="kt">string</span> <span class="o">|</span> <span class="kt">string</span><span class="p">[]</span> <span class="o">|</span> <span class="kc">null</span> <span class="o">|</span> <span class="kc">undefined</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Let&rsquo;s now apply the <code>NonNullable&lt;T&gt;</code> type to <code>EmailAddress</code> and resolve the resulting type step by step:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">NonNullableEmailAddress</span> <span class="o">=</span> <span class="nx">NonNullable</span><span class="p">&lt;</span><span class="nt">EmailAddress</span><span class="p">&gt;;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We&rsquo;ll start by replacing <code>EmailAddress</code> by the union type that it aliases:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">NonNullableEmailAddress</span> <span class="o">=</span> <span class="nx">NonNullable</span><span class="o">&lt;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">string</span> <span class="o">|</span> <span class="kt">string</span><span class="p">[]</span> <span class="o">|</span> <span class="kc">null</span> <span class="o">|</span> <span class="kc">undefined</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Here&rsquo;s where the distributive nature of conditional types comes into play. We&rsquo;re applying the <code>NonNullable&lt;T&gt;</code> type to a union type; this is equivalent to applying the conditional type to all types in the union type:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">NonNullableEmailAddress</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">  <span class="o">|</span> <span class="nx">NonNullable</span><span class="p">&lt;</span><span class="nt">string</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">|</span> <span class="nx">NonNullable</span><span class="p">&lt;</span><span class="nt">string</span><span class="err">[]</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">|</span> <span class="nx">NonNullable</span><span class="p">&lt;</span><span class="nt">null</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">|</span> <span class="nx">NonNullable</span><span class="p">&lt;</span><span class="nt">undefined</span><span class="p">&gt;;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We can now replace <code>NonNullable&lt;T&gt;</code> by its definition everywhere:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">NonNullableEmailAddress</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">  <span class="o">|</span> <span class="p">(</span><span class="kt">string</span> <span class="kr">extends</span> <span class="kc">null</span> <span class="o">|</span> <span class="kc">undefined</span> <span class="o">?</span> <span class="kt">never</span> <span class="o">:</span> <span class="kt">string</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">|</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="kr">extends</span> <span class="kc">null</span> <span class="o">|</span> <span class="kc">undefined</span> <span class="o">?</span> <span class="kt">never</span> <span class="o">:</span> <span class="kt">string</span><span class="p">[])</span>
</span></span><span class="line"><span class="cl">  <span class="o">|</span> <span class="p">(</span><span class="kc">null</span> <span class="kr">extends</span> <span class="kc">null</span> <span class="o">|</span> <span class="kc">undefined</span> <span class="o">?</span> <span class="kt">never</span> <span class="o">:</span> <span class="kc">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">|</span> <span class="p">(</span><span class="kc">undefined</span> <span class="kr">extends</span> <span class="kc">null</span> <span class="o">|</span> <span class="kc">undefined</span> <span class="o">?</span> <span class="kt">never</span> <span class="o">:</span> <span class="kc">undefined</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Next, we&rsquo;ll have to resolve each of the four conditional types. Neither <code>string</code> nor <code>string[]</code> are assignable to <code>null | undefined</code>, which is why the first two types select <code>string</code> and <code>string[]</code>. Both <code>null</code> and <code>undefined</code> are assignable to <code>null | undefined</code>, which is why both the last two types select <code>never</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">NonNullableEmailAddress</span> <span class="o">=</span> <span class="kt">string</span> <span class="o">|</span> <span class="kt">string</span><span class="p">[]</span> <span class="o">|</span> <span class="kt">never</span> <span class="o">|</span> <span class="kt">never</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><span class="ibakuman-inline-note">Because <code>never</code> is a subtype of every type, we can omit it from the union type. This leaves us with the final result:</span></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">NonNullableEmailAddress</span> <span class="o">=</span> <span class="kt">string</span> <span class="o">|</span> <span class="kt">string</span><span class="p">[];</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>And that&rsquo;s indeed what we would expect our type to be!</p>
<h2 id="mapped-types-with-conditional-types">Mapped Types with Conditional Types</h2>
<p>Let&rsquo;s now look at a more complex example that combines mapped types with conditional types. Here, we&rsquo;re defining a <span class="ibakuman-inline-note">type that extracts all non-nullable property keys from a type:</span></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">NonNullablePropertyKeys</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">&gt;</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">P</span> <span class="k">in</span> <span class="k">keyof</span> <span class="nx">T</span><span class="p">]</span><span class="o">:</span> <span class="kc">null</span> <span class="kr">extends</span> <span class="nx">T</span><span class="p">[</span><span class="nx">P</span><span class="p">]</span> <span class="o">?</span> <span class="kt">never</span> <span class="o">:</span> <span class="nx">P</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}[</span><span class="k">keyof</span> <span class="nx">T</span><span class="p">];</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>This type might seem quite <span class="ibakuman-inline-translation">cryptic<sub> { 神秘的，含义模糊的 }</sub></span> at first. Once again, I&rsquo;ll attempt to <span class="ibakuman-inline-translation">demystify<sub> { 使非神秘化 }</sub></span> it by looking at a concrete example and resolving the resulting type step by step.</p>
<p>Let&rsquo;s say we have a <code>User</code> type and want to use the <code>NonNullablePropertyKeys&lt;T&gt;</code> type to find out which properties are non-nullable:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">User</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">name</span>: <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">email</span>: <span class="kt">string</span> <span class="o">|</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">NonNullableUserPropertyKeys</span> <span class="o">=</span> <span class="nx">NonNullablePropertyKeys</span><span class="p">&lt;</span><span class="nt">User</span><span class="p">&gt;;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Here&rsquo;s how we can resolve <code>NonNullablePropertyKeys&lt;User&gt;</code>. First, we&rsquo;ll supply the <code>User</code> type as a type argument for the <code>T</code> type parameter:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">NonNullableUserPropertyKeys</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">P</span> <span class="k">in</span> <span class="k">keyof</span> <span class="nx">User</span><span class="p">]</span><span class="o">:</span> <span class="kc">null</span> <span class="kr">extends</span> <span class="nx">User</span><span class="p">[</span><span class="nx">P</span><span class="p">]</span> <span class="o">?</span> <span class="kt">never</span> <span class="o">:</span> <span class="nx">P</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}[</span><span class="k">keyof</span> <span class="nx">User</span><span class="p">];</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Second, we&rsquo;ll resolve <code>keyof User</code> within the mapped type. The <code>User</code> type has two properties, <code>name</code> and <code>email</code>, so we&rsquo;ll end up with a union type with the <code>&quot;name&quot;</code> and <code>&quot;email&quot;</code> <a class="link" href="https://mariusschulz.com/blog/string-literal-types-in-typescript"  target="_blank" rel="noopener"
    >string literal types</a>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">NonNullableUserPropertyKeys</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">P</span> <span class="k">in</span> <span class="s2">&#34;name&#34;</span> <span class="o">|</span> <span class="s2">&#34;email&#34;</span><span class="p">]</span><span class="o">:</span> <span class="kc">null</span> <span class="kr">extends</span> <span class="nx">User</span><span class="p">[</span><span class="nx">P</span><span class="p">]</span> <span class="o">?</span> <span class="kt">never</span> <span class="o">:</span> <span class="nx">P</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}[</span><span class="k">keyof</span> <span class="nx">User</span><span class="p">];</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Next, we&rsquo;ll <span class="ibakuman-inline-translation">unroll<sub> { 展开 }</sub></span> the <code>P in …</code> mapping and substitute <code>&quot;name&quot;</code> and <code>&quot;email&quot;</code> for the <code>P</code> type:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">NonNullableUserPropertyKeys</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">name</span>: <span class="kt">null</span> <span class="kr">extends</span> <span class="nx">User</span><span class="p">[</span><span class="s2">&#34;name&#34;</span><span class="p">]</span> <span class="o">?</span> <span class="kt">never</span> <span class="o">:</span> <span class="s2">&#34;name&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">email</span>: <span class="kt">null</span> <span class="kr">extends</span> <span class="nx">User</span><span class="p">[</span><span class="s2">&#34;email&#34;</span><span class="p">]</span> <span class="o">?</span> <span class="kt">never</span> <span class="o">:</span> <span class="s2">&#34;email&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}[</span><span class="k">keyof</span> <span class="nx">User</span><span class="p">];</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We can then go ahead and resolve the <a class="link" href="https://mariusschulz.com/blog/keyof-and-lookup-types-in-typescript"  target="_blank" rel="noopener"
    >indexed access types</a> <code>User[&quot;name&quot;]</code> and <code>User[&quot;email&quot;]</code> by looking up the types of the <code>name</code> and <code>email</code> properties in <code>User</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">NonNullableUserPropertyKeys</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">name</span>: <span class="kt">null</span> <span class="kr">extends</span> <span class="kt">string</span> <span class="o">?</span> <span class="kt">never</span> <span class="o">:</span> <span class="s2">&#34;name&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">email</span>: <span class="kt">null</span> <span class="kr">extends</span> <span class="kt">string</span> <span class="o">|</span> <span class="kc">null</span> <span class="o">?</span> <span class="kt">never</span> <span class="o">:</span> <span class="s2">&#34;email&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}[</span><span class="k">keyof</span> <span class="nx">User</span><span class="p">];</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now it&rsquo;s time to apply our conditional type. <code>null</code> does not extend <code>string</code>, but it does extend <code>string | null</code> — we therefore end up with the <code>&quot;name&quot;</code> and <code>never</code> types, respectively:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">NonNullableUserPropertyKeys</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;name&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">email</span>: <span class="kt">never</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}[</span><span class="k">keyof</span> <span class="nx">User</span><span class="p">];</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We&rsquo;re now done with both the mapped type and the conditional type. Once more, we&rsquo;ll resolve <code>keyof User</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">NonNullableUserPropertyKeys</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;name&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">email</span>: <span class="kt">never</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}[</span><span class="s2">&#34;name&#34;</span> <span class="o">|</span> <span class="s2">&#34;email&#34;</span><span class="p">];</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We now have an indexed access type that looks up the types of the <code>name</code> and <code>email</code> properties. <span class="ibakuman-inline-note">TypeScript resolves it by looking up each type individually and creating a union type of the results:</span></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">NonNullableUserPropertyKeys</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">  <span class="o">|</span> <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;name&#34;</span><span class="p">;</span> <span class="nx">email</span>: <span class="kt">never</span> <span class="p">}[</span><span class="s2">&#34;name&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="o">|</span> <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;name&#34;</span><span class="p">;</span> <span class="nx">email</span>: <span class="kt">never</span> <span class="p">}[</span><span class="s2">&#34;email&#34;</span><span class="p">];</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We&rsquo;re almost done! We can now look up the <code>name</code> and <code>email</code> properties in our two object types. The <code>name</code> property has type <code>&quot;name&quot;</code> and the <code>email</code> property has type <code>never</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">NonNullableUserPropertyKeys</span> <span class="o">=</span> <span class="s2">&#34;name&#34;</span> <span class="o">|</span> <span class="kt">never</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>And just like before, we can simplify the resulting union type by <span class="ibakuman-inline-translation">purging<sub> { 清洗；消除 }</sub></span> the <code>never</code> type:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">NonNullableUserPropertyKeys</span> <span class="o">=</span> <span class="s2">&#34;name&#34;</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>That&rsquo;s it! The only non-nullable property key in our <code>User</code> type is <code>&quot;name&quot;</code>.</p>
<p>Let&rsquo;s take this example one step further and define a type that extracts all non-nullable properties of a given type. We can use the <code>Pick&lt;T, K&gt;</code> type to , which is predefined in <em>lib.es5.d.ts</em>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * From T, pick a set of properties
</span></span></span><span class="line"><span class="cl"><span class="cm"> * whose keys are in the union K
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Pick</span><span class="p">&lt;</span><span class="nt">T</span><span class="err">,</span> <span class="na">K</span> <span class="na">extends</span> <span class="na">keyof</span> <span class="na">T</span><span class="p">&gt;</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">P</span> <span class="k">in</span> <span class="nx">K</span><span class="p">]</span><span class="o">:</span> <span class="nx">T</span><span class="p">[</span><span class="nx">P</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We can combine our <code>NonNullablePropertyKeys&lt;T&gt;</code> type with <code>Pick&lt;T, K&gt;</code> to define <code>NonNullableProperties&lt;T&gt;</code>, which is the type that we were looking for:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">NonNullableProperties</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">&gt;</span> <span class="o">=</span> <span class="nx">Pick</span><span class="p">&lt;</span><span class="nt">T</span><span class="err">,</span> <span class="na">NonNullablePropertyKeys</span><span class="err">&lt;</span><span class="na">T</span><span class="p">&gt;</span><span class="o">&gt;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">NonNullableUserProperties</span> <span class="o">=</span> <span class="nx">NonNullableProperties</span><span class="p">&lt;</span><span class="nt">User</span><span class="p">&gt;;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// { name: string }
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>And indeed, this is the type we would expect: in our <code>User</code> type, only the <code>name</code> property is non-nullable.</p>
<h2 id="type-inference-in-conditional-types">Type Inference in Conditional Types</h2>
<p>Another useful feature that conditional types support is inferring type variables using the <code>infer</code> keyword. Within the <code>extends</code> clause of a conditional type, you can use the <code>infer</code> keyword to infer a type variable, effectively performing pattern matching on types:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">First</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">&gt;</span> <span class="o">=</span> <span class="nx">T</span> <span class="kr">extends</span> <span class="p">[</span><span class="k">infer</span> <span class="nx">U</span><span class="p">,</span> <span class="p">...</span><span class="kt">unknown</span><span class="p">[]]</span> <span class="o">?</span> <span class="nx">U</span> : <span class="kt">never</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">SomeTupleType</span> <span class="o">=</span> <span class="p">[</span><span class="kt">string</span><span class="p">,</span> <span class="kt">number</span><span class="p">,</span> <span class="kr">boolean</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">FirstElementType</span> <span class="o">=</span> <span class="nx">First</span><span class="p">&lt;</span><span class="nt">SomeTupleType</span><span class="p">&gt;;</span> <span class="c1">// string
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><span class="ibakuman-inline-note">Note that the inferred type variables (in this case, <code>U</code>) can only be used in the true branch of the conditional type.</span></p>
<p>A <span class="ibakuman-inline-translation">long-standing<sub> { 长期存在的；存在已久的 }</sub></span> feature request for TypeScript has been the ability to extract the return type of a given function. Here&rsquo;s a simplified version of the <code>ReturnType&lt;T&gt;</code> type that&rsquo;s predefined in <em>lib.es5.d.ts</em>. It uses the <code>infer</code> keyword to infer the return type of a function type:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">ReturnType</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">&gt;</span> <span class="o">=</span> <span class="nx">T</span> <span class="kr">extends</span> <span class="p">(...</span><span class="nx">args</span>: <span class="kt">any</span><span class="p">[])</span> <span class="o">=&gt;</span> <span class="k">infer</span> <span class="nx">R</span> <span class="o">?</span> <span class="nx">R</span> : <span class="kt">any</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">A</span> <span class="o">=</span> <span class="nx">ReturnType</span><span class="o">&lt;</span><span class="p">()</span> <span class="o">=&gt;</span> <span class="kt">string</span><span class="o">&gt;</span><span class="p">;</span> <span class="c1">// string
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">B</span> <span class="o">=</span> <span class="nx">ReturnType</span><span class="o">&lt;</span><span class="p">()</span> <span class="o">=&gt;</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="kt">any</span><span class="p">[]</span><span class="o">&gt;</span><span class="p">;</span> <span class="c1">// () =&gt; any[]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">C</span> <span class="o">=</span> <span class="nx">ReturnType</span><span class="p">&lt;</span><span class="nt">typeof</span> <span class="na">Math.random</span><span class="p">&gt;;</span> <span class="c1">// number
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">D</span> <span class="o">=</span> <span class="nx">ReturnType</span><span class="p">&lt;</span><span class="nt">typeof</span> <span class="na">Array.isArray</span><span class="p">&gt;;</span> <span class="c1">// boolean
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Note that we have to use <code>typeof</code> to obtain the return type of the <code>Math.random()</code> and <code>Array.isArray()</code> methods. We need to pass a <em>type</em> as an argument for the type parameter <code>T</code>, not a <em>value</em>; this is why <code>ReturnType&lt;Math.random&gt;</code> and <code>ReturnType&lt;Array.isArray&gt;</code> would be incorrect.</p>
<p>For more information on how <code>infer</code> works, check out <a class="link" href="https://github.com/Microsoft/TypeScript/pull/21496"  target="_blank" rel="noopener"
    >this pull request</a> in which Anders Hejlsberg introduced type inference in conditional types.</p>
<h2 id="predefined-conditional-types">Predefined Conditional Types</h2>
<p>Conditional types are definitely an advanced feature of TypeScript&rsquo;s type system. To give you some more examples of what they can be used for, I want to <span class="ibakuman-inline-translation">go over<sub> { 复习，重温；仔细检查 }</sub></span> the conditional types that are predefined in TypeScript&rsquo;s <em>lib.es5.d.ts</em> file.</p>
<h3 id="the-nonnullablet-conditional-type">The <code>NonNullable&lt;T&gt;</code> Conditional Type</h3>
<p>We&rsquo;ve already seen and used the <code>NonNullable&lt;T&gt;</code> type which filters out the <code>null</code> and <code>undefined</code> types from <code>T</code>.</p>
<p>The definition:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Exclude null and undefined from T
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">NonNullable</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">&gt;</span> <span class="o">=</span> <span class="nx">T</span> <span class="kr">extends</span> <span class="kc">null</span> <span class="o">|</span> <span class="kc">undefined</span> <span class="o">?</span> <span class="kt">never</span> <span class="o">:</span> <span class="nx">T</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Some examples:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">A</span> <span class="o">=</span> <span class="nx">NonNullable</span><span class="p">&lt;</span><span class="nt">boolean</span><span class="p">&gt;;</span> <span class="c1">// boolean
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">B</span> <span class="o">=</span> <span class="nx">NonNullable</span><span class="p">&lt;</span><span class="nt">number</span> <span class="err">|</span> <span class="na">null</span><span class="p">&gt;;</span> <span class="c1">// number
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">C</span> <span class="o">=</span> <span class="nx">NonNullable</span><span class="p">&lt;</span><span class="nt">string</span> <span class="err">|</span> <span class="na">undefined</span><span class="p">&gt;;</span> <span class="c1">// string
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">D</span> <span class="o">=</span> <span class="nx">NonNullable</span><span class="p">&lt;</span><span class="nt">null</span> <span class="err">|</span> <span class="na">undefined</span><span class="p">&gt;;</span> <span class="c1">// never
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Note how the empty type <code>D</code> is represented by <code>never</code>.</p>
<h3 id="the-extractt-u-conditional-type">The <code>Extract&lt;T, U&gt;</code> Conditional Type</h3>
<p>The <code>Extract&lt;T, U&gt;</code> type lets us filter the type <code>T</code> and <em>keep</em> all those types that are assignable to <code>U</code>.</p>
<p>The definition:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Extract from T those types that are assignable to U
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Extract</span><span class="p">&lt;</span><span class="nt">T</span><span class="err">,</span> <span class="na">U</span><span class="p">&gt;</span> <span class="o">=</span> <span class="nx">T</span> <span class="kr">extends</span> <span class="nx">U</span> <span class="o">?</span> <span class="nx">T</span> : <span class="kt">never</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Some examples:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">A</span> <span class="o">=</span> <span class="nx">Extract</span><span class="p">&lt;</span><span class="nt">string</span> <span class="err">|</span> <span class="na">string</span><span class="err">[],</span> <span class="na">any</span><span class="err">[]</span><span class="p">&gt;;</span> <span class="c1">// string[]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">B</span> <span class="o">=</span> <span class="nx">Extract</span><span class="o">&lt;</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">)</span> <span class="o">|</span> <span class="kc">null</span><span class="p">,</span> <span class="nb">Function</span><span class="o">&gt;</span><span class="p">;</span> <span class="c1">// () =&gt; void
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">C</span> <span class="o">=</span> <span class="nx">Extract</span><span class="p">&lt;</span><span class="nt">200</span> <span class="err">|</span> <span class="na">400</span><span class="err">,</span> <span class="na">200</span> <span class="err">|</span> <span class="na">201</span><span class="p">&gt;;</span> <span class="c1">// 200
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">D</span> <span class="o">=</span> <span class="nx">Extract</span><span class="p">&lt;</span><span class="nt">number</span><span class="err">,</span> <span class="na">boolean</span><span class="p">&gt;;</span> <span class="c1">// never
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="the-excludet-u-conditional-type">The <code>Exclude&lt;T, U&gt;</code> Conditional Type</h3>
<p>The <code>Exclude&lt;T, U&gt;</code> type lets us filter the type <code>T</code> and keep those types that are <em>not</em> assignable to <code>U</code>. It is the <span class="ibakuman-inline-translation">counterpart<sub> { 对应的人（或事物） }</sub></span> of the <code>Extract&lt;T, U&gt;</code> type.</p>
<p>The definition:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Exclude from T those types that are assignable to U
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Exclude</span><span class="p">&lt;</span><span class="nt">T</span><span class="err">,</span> <span class="na">U</span><span class="p">&gt;</span> <span class="o">=</span> <span class="nx">T</span> <span class="kr">extends</span> <span class="nx">U</span> <span class="o">?</span> <span class="kt">never</span> <span class="o">:</span> <span class="nx">T</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Some examples:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">A</span> <span class="o">=</span> <span class="nx">Exclude</span><span class="p">&lt;</span><span class="nt">string</span> <span class="err">|</span> <span class="na">string</span><span class="err">[],</span> <span class="na">any</span><span class="err">[]</span><span class="p">&gt;;</span> <span class="c1">// string
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">B</span> <span class="o">=</span> <span class="nx">Exclude</span><span class="o">&lt;</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">)</span> <span class="o">|</span> <span class="kc">null</span><span class="p">,</span> <span class="nb">Function</span><span class="o">&gt;</span><span class="p">;</span> <span class="c1">// null
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">C</span> <span class="o">=</span> <span class="nx">Exclude</span><span class="p">&lt;</span><span class="nt">200</span> <span class="err">|</span> <span class="na">400</span><span class="err">,</span> <span class="na">200</span> <span class="err">|</span> <span class="na">201</span><span class="p">&gt;;</span> <span class="c1">// 400
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">D</span> <span class="o">=</span> <span class="nx">Exclude</span><span class="p">&lt;</span><span class="nt">number</span><span class="err">,</span> <span class="na">boolean</span><span class="p">&gt;;</span> <span class="c1">// number
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="the-returntypet-conditional-type">The <code>ReturnType&lt;T&gt;</code> Conditional Type</h3>
<p>As we&rsquo;ve seen above, the <code>ReturnType&lt;T&gt;</code> lets us extract the return type of a function type.</p>
<p>The definition:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Obtain the return type of a function type
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">ReturnType</span><span class="p">&lt;</span><span class="nt">T</span> <span class="na">extends</span> <span class="err">(</span><span class="na">...args</span><span class="err">:</span> <span class="na">any</span><span class="err">[])</span> <span class="err">=</span><span class="p">&gt;</span> <span class="kt">any</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nx">T</span> <span class="kr">extends</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">...</span><span class="nx">args</span>: <span class="kt">any</span><span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">infer</span> <span class="nx">R</span>
</span></span><span class="line"><span class="cl">  <span class="o">?</span> <span class="nx">R</span>
</span></span><span class="line"><span class="cl">  : <span class="kt">any</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Some examples:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">A</span> <span class="o">=</span> <span class="nx">ReturnType</span><span class="o">&lt;</span><span class="p">()</span> <span class="o">=&gt;</span> <span class="kt">string</span><span class="o">&gt;</span><span class="p">;</span> <span class="c1">// string
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">B</span> <span class="o">=</span> <span class="nx">ReturnType</span><span class="o">&lt;</span><span class="p">()</span> <span class="o">=&gt;</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="kt">any</span><span class="p">[]</span><span class="o">&gt;</span><span class="p">;</span> <span class="c1">// () =&gt; any[]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">C</span> <span class="o">=</span> <span class="nx">ReturnType</span><span class="p">&lt;</span><span class="nt">typeof</span> <span class="na">Math.random</span><span class="p">&gt;;</span> <span class="c1">// number
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">D</span> <span class="o">=</span> <span class="nx">ReturnType</span><span class="p">&lt;</span><span class="nt">typeof</span> <span class="na">Array.isArray</span><span class="p">&gt;;</span> <span class="c1">// boolean
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="the-parameterst-conditional-type">The <code>Parameters&lt;T&gt;</code> Conditional Type</h3>
<p>The <code>Parameters&lt;T&gt;</code> type lets us extract all parameter types of a function type. It produces a tuple type with all the parameter types (or the type <code>never</code> if <code>T</code> is not a function).</p>
<p>The definition:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Obtain the parameters of a function type in a tuple
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Parameters</span><span class="p">&lt;</span><span class="nt">T</span> <span class="na">extends</span> <span class="err">(</span><span class="na">...args</span><span class="err">:</span> <span class="na">any</span><span class="err">[])</span> <span class="err">=</span><span class="p">&gt;</span> <span class="kt">any</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nx">T</span> <span class="kr">extends</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">...</span><span class="nx">args</span>: <span class="kt">infer</span> <span class="nx">P</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">=&gt;</span> <span class="kt">any</span>
</span></span><span class="line"><span class="cl">  <span class="o">?</span> <span class="nx">P</span>
</span></span><span class="line"><span class="cl">  : <span class="kt">never</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Notice that the <code>Parameters&lt;T&gt;</code> type is almost identical in structure to the <code>ReturnType&lt;T&gt;</code> type. The main difference is the placement of the <code>infer</code> keyword.</p>
<p>Some examples:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">A</span> <span class="o">=</span> <span class="nx">Parameters</span><span class="o">&lt;</span><span class="p">()</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="o">&gt;</span><span class="p">;</span> <span class="c1">// []
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">B</span> <span class="o">=</span> <span class="nx">Parameters</span><span class="p">&lt;</span><span class="nt">typeof</span> <span class="na">Array.isArray</span><span class="p">&gt;;</span> <span class="c1">// [any]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">C</span> <span class="o">=</span> <span class="nx">Parameters</span><span class="p">&lt;</span><span class="nt">typeof</span> <span class="na">parseInt</span><span class="p">&gt;;</span> <span class="c1">// [string, (number | undefined)?]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">D</span> <span class="o">=</span> <span class="nx">Parameters</span><span class="p">&lt;</span><span class="nt">typeof</span> <span class="na">Math.max</span><span class="p">&gt;;</span> <span class="c1">// number[]
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>The <code>Array.isArray()</code> method expects exactly one argument of an arbitrary type; this is why type <code>B</code> is resolved as <code>[any]</code>, a tuple with exactly one element. The <code>Math.max()</code> method, on the other hand, expects arbitrarily many numeric arguments (<em>not</em> a single array argument); therefore, type <code>D</code> is resolved as <code>number[]</code> (and not <code>[number[]]</code>).</p>
<h3 id="the-constructorparameterst-conditional-type">The <code>ConstructorParameters&lt;T&gt;</code> Conditional Type</h3>
<p>The <code>ConstructorParameters&lt;T&gt;</code> type lets us extract all parameter types of a constructor function type. It produces a tuple type with all the parameter types (or the type <code>never</code> if <code>T</code> is not a function).</p>
<p>The definition:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Obtain the parameters of a constructor function type in a tuple
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">ConstructorParameters</span><span class="o">&lt;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">T</span> <span class="kr">extends</span> <span class="k">new</span> <span class="p">(...</span><span class="nx">args</span>: <span class="kt">any</span><span class="p">[])</span> <span class="o">=&gt;</span> <span class="kt">any</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;</span> <span class="o">=</span> <span class="nx">T</span> <span class="kr">extends</span> <span class="k">new</span> <span class="p">(...</span><span class="nx">args</span>: <span class="kt">infer</span> <span class="nx">P</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="kt">any</span> <span class="o">?</span> <span class="nx">P</span> : <span class="kt">never</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Notice that the <code>ConstructorParameters&lt;T&gt;</code> type is almost identical to the <code>Parameters&lt;T&gt;</code> type. <span class="ibakuman-inline-note">The only difference is the additional <code>new</code> keyword that indicates that the function can be constructed.
</span>
Some examples:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">A</span> <span class="o">=</span> <span class="nx">ConstructorParameters</span><span class="p">&lt;</span><span class="nt">ErrorConstructor</span><span class="p">&gt;;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// [(string | undefined)?]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">B</span> <span class="o">=</span> <span class="nx">ConstructorParameters</span><span class="p">&lt;</span><span class="nt">FunctionConstructor</span><span class="p">&gt;;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// string[]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">C</span> <span class="o">=</span> <span class="nx">ConstructorParameters</span><span class="p">&lt;</span><span class="nt">RegExpConstructor</span><span class="p">&gt;;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// [string, (string | undefined)?]
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="the-instancetypet-conditional-type">The <code>InstanceType&lt;T&gt;</code> Conditional Type</h3>
<p>The <code>InstanceType&lt;T&gt;</code> type lets us extract the return type of a constructor function type. It is the equivalent of <code>ReturnType&lt;T&gt;</code> for constructor functions.</p>
<p>The definition:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Obtain the return type of a constructor function type
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">InstanceType</span><span class="p">&lt;</span><span class="nt">T</span> <span class="na">extends</span> <span class="na">new</span> <span class="err">(</span><span class="na">...args</span><span class="err">:</span> <span class="na">any</span><span class="err">[])</span> <span class="err">=</span><span class="p">&gt;</span> <span class="kt">any</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nx">T</span> <span class="kr">extends</span> <span class="k">new</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">...</span><span class="nx">args</span>: <span class="kt">any</span><span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">infer</span> <span class="nx">R</span>
</span></span><span class="line"><span class="cl">  <span class="o">?</span> <span class="nx">R</span>
</span></span><span class="line"><span class="cl">  : <span class="kt">any</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Once again, notice how the <code>InstanceType&lt;T&gt;</code> type is very similar in structure to the <code>ReturnType&lt;T&gt;</code> and <code>ConstructorParameters&lt;T&gt;</code> types.</p>
<p>Some examples:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">A</span> <span class="o">=</span> <span class="nx">InstanceType</span><span class="p">&lt;</span><span class="nt">ErrorConstructor</span><span class="p">&gt;;</span> <span class="c1">// Error
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">B</span> <span class="o">=</span> <span class="nx">InstanceType</span><span class="p">&lt;</span><span class="nt">FunctionConstructor</span><span class="p">&gt;;</span> <span class="c1">// Function
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">C</span> <span class="o">=</span> <span class="nx">InstanceType</span><span class="p">&lt;</span><span class="nt">RegExpConstructor</span><span class="p">&gt;;</span> <span class="c1">// RegExp
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="references">References</h2>
<ul>
<li><a class="link" href="https://mariusschulz.com/blog/conditional-types-in-typescript"  target="_blank" rel="noopener"
    >Conditional Types in TypeScript — Marius Schulz</a></li>
</ul>

</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>

</article>


    

    

    <aside class="related-content--wrapper">
        <h2 class="section-title">Related content</h2>
        <div class="related-content">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/en/posts/typescript/typescript-evolution/046-string-literal-types-in-typescript/">

        
            <div class="article-image">
                <img src="/gallery/landscape/33.93a18093c97b5d70c9fda4f4f0835498_hu66ca492386bb42c90e91c813efc08adf_1739420_250x150_fill_q75_box_smart1.jpg"
                        width="250"
                        height="150"
                        loading="lazy"
                        alt="Featured image of post String Literal Types in TypeScript"
                        
                        data-hash="md5-k6GAk8l7XXDJ/aT08INUmA==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">String Literal Types in TypeScript</h2>
        </div>
    </a>
</article>

                
                    
<article class="has-image">
    <a href="/en/posts/typescript/typescript-evolution/045-assertion-functions-in-typescript/">

        
            <div class="article-image">
                <img src="/gallery/landscape/29.53d06ddeed9e7c747c87c4da23b8fdf3_hu8940b943a3a3cf8f8bedd9ed1cbe7245_2487543_250x150_fill_q75_box_smart1.jpg"
                        width="250"
                        height="150"
                        loading="lazy"
                        alt="Featured image of post Assertion Functions in TypeScript"
                        
                        data-hash="md5-U9Bt3u2efHR8h8TaI7j98w==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Assertion Functions in TypeScript</h2>
        </div>
    </a>
</article>

                
                    
<article class="has-image">
    <a href="/en/posts/typescript/typescript-evolution/044-optional-chaining-the-operator-in-typescript/">

        
            <div class="article-image">
                <img src="/gallery/landscape/30.45fe68f0d5e73cec08d4f6208a73548c_hu6b33f88901e241f064888f7143885028_2042071_250x150_fill_q75_box_smart1.jpg"
                        width="250"
                        height="150"
                        loading="lazy"
                        alt="Featured image of post Optional Chaining: The ?. Operator in TypeScript"
                        
                        data-hash="md5-Rf5o8NXnPOwI1PYginNUjA==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Optional Chaining: The ?. Operator in TypeScript</h2>
        </div>
    </a>
</article>

                
                    
<article class="has-image">
    <a href="/en/posts/typescript/typescript-evolution/043-nullish-coalescing-the-operator-in-typescript/">

        
            <div class="article-image">
                <img src="/gallery/landscape/18.1d6c831bbe3ac5066415b0e3b01e7d47_hu7a8b922ea914ad8a12e0fc01dcf809f5_223556_250x150_fill_q75_box_smart1.jpg"
                        width="250"
                        height="150"
                        loading="lazy"
                        alt="Featured image of post Nullish Coalescing: The ?? Operator in TypeScript"
                        
                        data-hash="md5-HWyDG746xQZkFbDjsB59Rw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Nullish Coalescing: The ?? Operator in TypeScript</h2>
        </div>
    </a>
</article>

                
                    
<article class="has-image">
    <a href="/en/posts/typescript/typescript-evolution/042-the-omit-helper-type-in-typescript/">

        
            <div class="article-image">
                <img src="/gallery/landscape/17.9800920920e8a9ef0cfbd3d8d3787fb2_hudbc1561b7a760b2f47477637bc223f35_938024_250x150_fill_q75_box_smart1.jpg"
                        width="250"
                        height="150"
                        loading="lazy"
                        alt="Featured image of post The Omit Helper Type in TypeScript"
                        
                        data-hash="md5-mACSCSDoqe8M&#43;9PY03h/sg==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">The Omit Helper Type in TypeScript</h2>
        </div>
    </a>
</article>

                
            </div>
        </div>
    </aside>


    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hugo-theme-stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onThemeModeChange', (e) => {
        if (typeof DISQUS == 'object') {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>


    
                <footer class="site-footer"><section class="copyright">
        &copy;
        
            2021 -
        
        2023 iBakuman&#39;s Blog
    </section>

    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.16.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>

            </main>
    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#introduction-to-conditional-types">Introduction to Conditional Types</a></li>
    <li><a href="#distributive-conditional-types">Distributive Conditional Types</a></li>
    <li><a href="#mapped-types-with-conditional-types">Mapped Types with Conditional Types</a></li>
    <li><a href="#type-inference-in-conditional-types">Type Inference in Conditional Types</a></li>
    <li><a href="#predefined-conditional-types">Predefined Conditional Types</a>
      <ol>
        <li><a href="#the-nonnullablet-conditional-type">The <code>NonNullable&lt;T&gt;</code> Conditional Type</a></li>
        <li><a href="#the-extractt-u-conditional-type">The <code>Extract&lt;T, U&gt;</code> Conditional Type</a></li>
        <li><a href="#the-excludet-u-conditional-type">The <code>Exclude&lt;T, U&gt;</code> Conditional Type</a></li>
        <li><a href="#the-returntypet-conditional-type">The <code>ReturnType&lt;T&gt;</code> Conditional Type</a></li>
        <li><a href="#the-parameterst-conditional-type">The <code>Parameters&lt;T&gt;</code> Conditional Type</a></li>
        <li><a href="#the-constructorparameterst-conditional-type">The <code>ConstructorParameters&lt;T&gt;</code> Conditional Type</a></li>
        <li><a href="#the-instancetypet-conditional-type">The <code>InstanceType&lt;T&gt;</code> Conditional Type</a></li>
      </ol>
    </li>
    <li><a href="#references">References</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <div class="fixed-buttons"><a href="#" class="fixed-buttons__back-to-top" class="fixed-button" title="">
                    <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
                </a><a href="#" id="fixed-buttons__view-comments" class="fixed-button" title="">
                    <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
                </a>
            </div>
        </div>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/ribbon.js@1.0.2/dist/ribbon.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.js"></script><script type="text/javascript">window.themeConfig={"code":{"copyTitle":"Copy to clipboard"},"folding":{"maxShownLines":40}};</script><script type="text/javascript" src="/ts/main.min.3a18546ecb79abf74f4b27df66faadb0bb2e74b596d89f228e44cda88aa926fb.js" integrity="sha256-OhhUbst5q/dPSyffZvqtsLsudLWW2J8ijkTNqIqpJvs="></script>
    </body>
</html>
